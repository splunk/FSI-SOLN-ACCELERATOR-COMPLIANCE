# Compliance Log Simulators (Drift & Non-Drift)

These scripts generate synthetic log data for various compliance domains (KYC, PCI, DORA, CPS230, RMiT).  
You can choose between **drift** simulators (which introduce schema and format drift) and **non-drift** simulators (which generate stable, standard-compliant logs).  
All scripts can send data to Splunk HEC or save it as a CSV file.  
**All scripts support dynamic control over the total number of events and the event rate per hour.**



## Lookup Table Generator Scripts

These scripts generate lookup CSVs for use in Splunk enrichment pipelines. They ensure that all simulated hosts, systems, and operations have corresponding metadata for contextual enrichment.

**Lookup Generators:**
- `generate_apjc_lookup.py` — Generates `apjc_asset_inventory.csv` for APJC region (host, criticality, business service, data center location).
- `generate_anz_lookup.py` — Generates `anz_critical_operations.csv` for A/NZ region (system_id, entity_id, critical operation, tolerance level, business unit).

**Usage:**
```sh
python generate_apjc_lookup.py
python generate_anz_lookup.py
```
Each script will create a CSV file in the current directory with all possible combinations based on the simulator's configuration lists. These lookup tables are designed to match the hosts and systems generated by the corresponding event simulators, ensuring full coverage for Splunk lookups.

**Record Counts:**
- APJC: 120 records (10 institutions × 12 systems)
- ANZ: 8 records (one per critical operation, sample logic; adjust as needed)

**Customization:**
Update the lists in the lookup generator scripts to match your real asset inventory or compliance requirements for full coverage.
---

## Usage

```sh
python <simulator_script>.py [OPTIONS]
```
Where `<simulator_script>.py` is one of:
- Drift simulators:
  - `kyc_drift_simulator.py`
  - `pci_drift_simulator.py`
  - `dora_drift_simulator.py`
  - `cps230_drift_simulator.py`
  - `rmit_drift_simulator.py`
- Non-drift simulators:
  - `kyc_simulator.py`
  - `pci_simulator.py`
  - `dora_simulator.py`
  - `cps230_simulator.py`
  - `rmit_simulator.py`
- Lookup generators:
  - `generate_apjc_lookup.py`
  - `generate_anz_lookup.py`

---

## Parameters

| Argument                | Type    | Default                      | Description                                                                                  |
|-------------------------|---------|------------------------------|----------------------------------------------------------------------------------------------|
| `--num-events`          | int     | 1000                         | Total number of events to generate.                                                          |
| `--output-csv`          | str     | `<script>_raw_logs.csv` or `<script>_schema_drift_raw_logs.csv` | Output CSV filename. If not specified and not sending to Splunk, defaults to this filename.  |
| `--send-to-splunk`      | flag    | False                        | If set, sends generated events to Splunk HEC.                                                |
| `--splunk-url`          | str     | See script default           | Splunk HEC endpoint URL.                    |
| `--splunk-token`        | str     | See script default           | Splunk HEC authentication token.         |
| `--splunk-index`        | str     | See script default           | Splunk index for raw drift data.            |
| `--splunk-source`       | str     | See script default           | Splunk source field. |
| `--splunk-sourcetype`   | str     | See script default           | Splunk sourcetype for data.                 |
| `--splunk-batch-size`   | int     | 100                          | Number of events per batch sent to HEC.      |
| `--splunk-disable-ssl-verify` | flag  | False                    | Disable SSL verification for HEC endpoint.   |
| `--hours-backfill-per-100` | float | 1.0 (varies by script)      | Hours to backfill timestamp for every 100 events (PCI, CPS230, RMiT simulators).             |
| `--events-per-hour`     | int     | 1000 (varies by script)      | Number of events to generate per hour of backfill (KYC, DORA drift simulators).              |
| `--output-file`         | str     | None                         | (KYC only) Output JSON file path. If not provided, prints to stdout.                         |

| `--num-events`          | int     | 1000                         | Total number of events to generate.                                                          |
| `--events-per-hour`     | int     | 1000                         | Number of events to generate per hour of backfill.                                           |
| `--output-csv`          | str     | `<script>_schema_drift_raw_logs.csv` or `<script>_raw_logs.csv` | Output CSV filename. If not specified and not sending to Splunk, defaults to this filename.  |
| `--send-to-splunk`      | flag    | False                        | If set, sends generated events to Splunk HEC.                                                |

### Splunk HEC Options

| Argument                    | Type    | Default                  | Description                                 |
|-----------------------------|---------|--------------------------|---------------------------------------------|
| `--splunk-url`              | str     | YOUR_SPLUNK_HEC_URL/...  | Splunk HEC endpoint URL.                    |
| `--splunk-token`            | str     | YOUR_HEC_TOKEN_FOR_RAW_DATA | Splunk HEC authentication token.         |
| `--splunk-index`            | str     | drift_raw_data           | Splunk index for raw drift data.            |
| `--splunk-source`           | str     | `<script>_drift_generator` or `<script>_generator` | Splunk source field. |
| `--splunk-sourcetype`       | str     | `<script>_drift_raw` or `<script>_raw`     | Splunk sourcetype for data.                 |
| `--splunk-batch-size`       | int     | 100                      | Number of events per batch sent to HEC.      |
| `--splunk-disable-ssl-verify` | flag  | False                    | Disable SSL verification for HEC endpoint.   |

---

## Example Commands

**Generate 10,000 PCI events with drift at 2,000 events per hour, save to CSV:**
```sh
python pci_drift_simulator.py --num-events 10000 --events-per-hour 2000 --output-csv my_pci_logs.csv
```

**Generate 10,000 PCI events (no drift) at default rate, save to CSV:**
```sh
python pci_simulator.py --num-events 10000 --output-csv my_pci_logs.csv
```

**Generate APJC asset inventory lookup for Splunk enrichment:**
```sh
python generate_apjc_lookup.py
# Output: apjc_asset_inventory.csv
```

**Generate ANZ critical operations lookup for Splunk enrichment:**
```sh
python generate_anz_lookup.py
# Output: anz_critical_operations.csv
```

**Generate 24,000 DORA events with drift at 1,000 events per hour and send to Splunk:**
```sh
python dora_drift_simulator.py --num-events 24000 --events-per-hour 1000 --send-to-splunk \
  --splunk-url https://splunk.example.com:8088/services/collector \
  --splunk-token YOUR_TOKEN --splunk-index my_index
```

**Generate 24,000 DORA events (no drift) at 1,000 events per hour and send to Splunk:**
```sh
python dora_simulator.py --num-events 24000 --events-per-hour 1000 --send-to-splunk \
  --splunk-url https://splunk.example.com:8088/services/collector \
  --splunk-token YOUR_TOKEN --splunk-index my_index
```

**Generate 168,000 RMiT events with drift at 1,000 events per hour (1 week of hourly data):**
```sh
python rmit_drift_simulator.py --num-events 168000 --events-per-hour 1000 --output-csv rmit_week.csv
```

**Generate 168,000 RMiT events (no drift) at 1,000 events per hour (1 week of hourly data):**
```sh
python rmit_simulator.py --num-events 168000 --events-per-hour 1000 --output-csv rmit_week.csv
```

**Generate 10,000 KYC events (no drift) and save to CSV:**
```sh
python kyc_simulator.py --num-events 10000 --output-csv my_kyc_logs.csv
```

**Generate 10,000 KYC events (no drift) and send to Splunk:**
```sh
python kyc_simulator.py --num-events 10000 --send-to-splunk --splunk-url https://splunk.example.com:8088/services/collector --splunk-token YOUR_TOKEN --splunk-index my_index
```

---

## Notes

- The script will automatically spread the generated events evenly over the calculated backfill window (`num-events / events-per-hour` hours) or using the hours-backfill-per-100 logic for some simulators.
- If neither `--output-csv` nor `--send-to-splunk` is specified, the script will default to saving the logs as `<script>_schema_drift_raw_logs.csv` for drift simulators or `<script>_raw_logs.csv` for non-drift simulators.
- For Splunk HEC, ensure the URL and token are set to valid values.
- Each script supports its own compliance domain and may have additional options or schema drift logic (for drift simulators).
- Use drift simulators to test Splunk or other SIEM/data pipelines for schema evolution and robustness; use non-drift simulators for standard, stable log ingestion and analytics.